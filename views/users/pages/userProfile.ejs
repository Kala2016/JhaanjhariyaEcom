<%- include('../partials/header.ejs')%>

<!-- Profile Section Begin -->
<div class="profile-section spad">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <div class="card shadow-sm">
          <div class="card-header bg-primary text-white text-center">
            <h4>Profile Settings</h4>
          </div>
          <div class="card-body">
            <div class="text-center mb-4">
              <h5>Hello, <%= user.fname + " " + user.lname %>!</h5>
            </div>
            <form id="registrationForm" action="/editProfile" method="post">
              <!-- Profile Form Content -->
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">First Name</label>
                    <input
                      class="form-control"
                      id="fname"
                      name="fname"
                      type="text"
                      value="<%= user.fname %>"
                      required
                    />
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Last Name</label>
                    <input
                      class="form-control"
                      id="lname"
                      name="lname"
                      type="text"
                      value="<%= user.lname %>"
                      required
                    />
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Email</label>
                    <input
                      class="form-control"
                      id="email"
                      name="email"
                      type="email"
                      value="<%= user.email %>"
                      disabled
                    />
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Phone</label>
                    <input
                      class="form-control"
                      id="mobile"
                      name="mobile"
                      type="tel"
                      value="<%= user.mobile %>"
                      required
                    />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Referral Code</label>
                    <div class="input-group">
                      <input
                        class="form-control"
                        id="referral-code"
                        type="text"
                        value="<%= user.referralCode %>"
                        readonly
                      />
                      <button class="btn btn-outline-secondary" type="button" id="copy-button">
                        <i class="fas fa-copy"></i>
                      </button>
                    </div>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">My Wallet Balance</label>
                    <a href="/wallet-history" class="btn btn-info form-control">
                      View Wallet History â‚¹ <%= (walletBalance).toLocaleString() %>
                    </a>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">My Orders</label>
                    <a href="/myorders" class="btn btn-info form-control">My Orders</a>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Change Password</label>
                    <a href="/changePassword" class="btn btn-info form-control">Change Password</a>
                  </div>
                </div>
              </div>
              <div class="text-center mt-4">
                <button
                  type="submit"
                  class="btn btn-outline-secondary"
                >
                  Save Changes
                </button>
                <a href="/addAddressPage" class="btn btn-secondary ml-2">
                  Add Address
                </a>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Profile Section End -->

<style>
  .profile-section {
    padding: 60px 0;
  }

  .card {
    border-radius: 10px;
  }

  .card-header {
    border-top-left-radius: 10px;
    border-top-right-radius: 10px;
  }

  .form-label {
    font-weight: bold;
    
  }
  .bg-primary{
    background-color: #e7ab3c !important;
  }

  .btn-secondary {
    background-color: #6c757d;
    border-color: #6c757d;
    color: white;
  }

  .btn-secondary:hover {
    background-color: #5a6268;
    border-color: #545b62;
  }

  .input-group .form-control {
    border-right: 0;
  }

  .input-group .btn {
    border-left: 0;
  }

  #copy-button {
    cursor: pointer;
  }

  #copy-button .fa-copy {
    font-size: 16px;
  }
</style>

<script>
  $(document).ready(function() {
    // Initialize Bootstrap tooltips
    $('[data-toggle="tooltip"]').tooltip();

    const copyButton = document.getElementById("copy-button");
    copyButton.addEventListener("click", function() {
      const referralCodeElement = document.getElementById("referral-code");
      const referralCode = referralCodeElement.value;
      const tempInput = document.createElement("input");
      tempInput.value = referralCode;
      document.body.appendChild(tempInput);
      tempInput.select();
      document.execCommand("copy");
      document.body.removeChild(tempInput);

      // Show the "Copied" tooltip
      $('#copy-button').attr('title', 'Copied').tooltip('show');

      // Hide the tooltip after a short delay
      setTimeout(function() {
        $('#copy-button').tooltip('hide');
      }, 2000);
    });
  });
</script>

<%- include('../partials/footer.ejs')%>
